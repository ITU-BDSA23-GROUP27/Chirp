@page
@model Chirp.Web.Pages.ClaimsModel
@{
}

@{
    if (!User.Identity?.IsAuthenticated == true)
    {
        RedirectToPage("/"); // Redirect to another page when the user is not authenticated
    }
}

<h2>User Claims</h2>
<div class="user-info">
    <p><span class="label">ID:</span> @Model.NameID</p>
    <p><span class="label">Username:</span> @Model.Username</p>
    <p class="github-info"><span class="label">Name:</span> @Model.Name</p>
    <p class="github-url"><span class="label">GitHub URL:</span> <a href="@Model.GithubURL"
            target="_blank">@Model.GithubURL</a></p>
</div>

<h2>User Claims</h2>
<div class="user-info">
    <p id="test"><span class="label">ID:</span> 1</p>
    <p><span class="label">Username:</span> @Model.Username</p>
    <p class="github-info"><span class="label">Name:</span> @Model.Name</p>
    <p class="github-url"><span class="label">GitHub URL:</span> <a href="@Model.GithubURL"
            target="_blank">@Model.GithubURL</a></p>
</div>

<div class="test"></div>

<script>
  // Wrap your code in a window load event listener
  window.onload = function() {
    // Get the source element by its class name
    var sourceElement = document.querySelector('.test');

    // URL of the GitHub API endpoint for a specific user
    var apiUrl = '@Model.GithubURL';

    // Fetch data from the GitHub API
    fetch(apiUrl)
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            // Extract the 'login' property from the fetched data
            var valueToCopy = data.login || '';
  
            // Put the value into the source element
            sourceElement.textContent = valueToCopy;
        })
        .catch(error => {
            console.error('Error fetching data:', error);
            sourceElement.textContent = 'Failed to fetch data';
        });
  };
</script>
